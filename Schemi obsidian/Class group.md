#VectorBundles_and_Divisors

The class group is defined so that the following is an exact sequence$$0\to \Oc(X)^\times\to k(X)^\times\xrightarrow\div\Div(X)\to \Cl(X)\to 0$$
If $A$ is a Noetherian normal domain then TFAE:
1. $\Cl(A)=0$
2. $\Spec(A)^{(1)}$ consists only of principal ideals
3. $A$ is UFD
Proof:
- ($3.\implies 2.$) If we had two or more generators then we can pick one and then a prime factor of it. This gives a principal prime ideal which is contained in the original one. If the height was one then the two ideals must have been the same.
- ($2.\implies 3.$) Let $a$ be irreducible and take $(a)\subseteq \pf$ with $\pf$ minimal, so of height 1 by the Hauptidealsatz. By assumption $\pf=(p)$ so $a=pb$ with $p$ prime and $a$ irreducible, it follows that $\pf=(a)$ and so $a$ is prime.
- ($2.\implies 1.$) All primitive divisors are principal ($\pf=(p)\implies \pf=\div p$)
- ($1.\implies 2.$) Suppose $\pf$ has height 1, then $\pf=\div f$ for some $f\in \Frac(A)^\times$. Since $\pf$ as a divisor is effective we have $f\in A$, so $f\in \pf=\cpa{a\in A\mid v_\pf(a)>0}$. If $g$ is any element of $\pf$ it follows that $g/f\in A$, again because $v_\pf(g)>0,v_\pf(f)=1\implies v_\pf(g/f)\geq 0$. Therefore $g\in (f)$, i.e. $f\in \pf\subseteq (f)$, so $\pf=(f)$.



We now introduce our main tool for computing class groups:
Let $X$ be Noetherian, integral normal and let $U\subseteq X$ be a non-empty open. Let $V_1,\cdots, V_r$ be the irreducible components of $X\bs U$ that have codimension 1. Then we have a surjective homomorphism $$\mathrm{res}_U:\funcDef{\Cl(X)}{\Cl(U)}{[p]}{\begin{cases}0 &\text{if }p\notin U\\ [p] &\text{if }p\in U\end{cases}}$$and the kernel is the subgroup generated by $[V_1],\cdots, [V_r]$.
- Surjectivity and being a homomorphism are evident.
- Let $[D]$ be an element of the kernel, that is, $\rbar D_U=\div(\rbar f_U)$. This means that $$D-\div f=\under{=0}{\rbar D_U-\div(\rbar f_U)}+\under{\in \ps{[V_1],\cdots, [V_r]}}{\rbar D_{X\bs U}}-\under{\in \ps{[V_1],\cdots, [V_r]}}{(\div f-\rbar{\div f}_U)}.$$
It follows that if $f\in k(X)^\times$ and we write $\rbar f_U\in k(U)^\times$ for that same element $f$ up to obvious identification then we have $\div(\rbar f_U)=\rbar{(\div f)}_U$.

By surjectivity we get that if $U\subseteq \A^n_k$ is open then $\Cl(U)=0$ since $k[x_1,\cdots, x_n]$ is a UFD.